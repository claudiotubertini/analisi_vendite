df = read.xls ("fatture_20160525.xls", sheet = 1, header = TRUE)
df2 = separate(data = df, col = Cliente_forn, into = c("cliente", "codice"), sep = "\\-")
df2$data = paste("2016", df2$Mese, df2$Giorno, sep = "/")
df_librerie = filter(df2, df2$Contributo == "")
df_contributi = filter(df2, df2$Contributo == "x")
View(df2)
df = read.xls ("fatture_20160525.xls", sheet = 1, header = TRUE)
df2 = separate(data = df, col = Cliente_forn, into = c("cliente", "codice"), sep = "\\-")
df_librerie = filter(df2, df2$Contributo == "")
df_contributi = filter(df2, df2$Contributo == "x")
df_contributi
library(dplyr)
df = read.xls ("fatture_20160525.xls", sheet = 1, header = TRUE)
df2 = separate(data = df, col = Cliente_forn, into = c("cliente", "codice"), sep = "\\-")
df2$data = paste("2016", df2$Mese, df2$Giorno, sep = "/")
df2$data <- as.Date(df2$data, "%Y/%m/%d")
df_librerie = filter(df2, df2$Contributo == "")
df_contributi = filter(df2, df2$Contributo == "x")
df_librerie$Settimana <- as.Date(cut(df_librerie$data, breaks = "week", start.on.monday = TRUE))
View(df_librerie)
ggplot(data = df_librerie,
aes(Settimana, Valore_fatturato)) +
stat_summary(fun.y = sum, geom = "bar") +
scale_x_date(labels = date_format("%Y-%m-%d"), breaks = "1 week")
ggplot(data = df_librerie,
aes(Settimana, Valore_fatturato)) +
stat_summary(fun.y = sum, geom = "bar")
setwd("/media/claudio/DATA/analisi_vendite")
plot(df_librerie)
plot(df_librerie$data, df_librerie$Valore_fatturato)
plot(df_librerie$data, df_librerie$Valore_fatturato, type = "l")
View(df2)
plot(df2[,c(1,10,11)])
install.packages("forecast")
library("forecast", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.3")
View(df_librerie)
df_librerie_by_week = group_by(df_librerie, Settimana)
fatturato_settimanale_librerie = summarise(df_librerie_by_week, fatturato = sum(Valore_fatturato))
View(fatturato_settimanale_librerie)
fatturato_settimanale_librerie = summarise(df_librerie_by_week, fatturato = sum(Valore_fatturato), count = n())
ggplot(fatturato_settimanale_librerie, aes(Settimana, fatturato)) +
geom_point(aes(size = count), alpha = 1/2) +
geom_smooth() +
scale_size_area()
myts <- ts(fatturato_settimanale_librerie$fatturato, start=c(1), end=c(24), frequency=7)
myts
24*7
myts <- ts(fatturato_settimanale_librerie$fatturato, start=c(1), end=c(24), frequency = 1)
myts
plot.ts(myts)
fit <- stl(myts, s.window="period")
plot(fit)
fit <- stl(myts, s.window="periodic")
fit <- stl(myts)
trend<-lm(Settimana ~ fatturato, data=fatturato_settimanale_librerie)
summary(trend)
fatturato_settimanale_librerie$base = nrows
fatturato_settimanale_librerie$base = nrows()
fatturato_settimanale_librerie$base = nrow()
trend<-lm(fatturato, data=fatturato_settimanale_librerie)
seq.int(24)
decompose(myts)
myts <- ts(fatturato_settimanale_librerie$fatturato, start=c(2016, 1), end=c(2016, 5), frequency=1)
myts <- ts(fatturato_settimanale_librerie$fatturato, frequency=1)
plot.ts(myts)
decompose(myts)
myts <- ts(fatturato_settimanale_librerie$fatturato, frequency=4)
decompose(myts)
components = decompose(myts)
plot(components)
HoltWinters(myts, beta=FALSE, gamma=FALSE)
myts_forecast = HoltWinters(myts, beta=FALSE, gamma=FALSE)
myts_forecast$fitted
plot(myts_forecast)
myts_forecast$SSE
forecast.HoltWinters(myts_forecast, h=5)
forecast.HoltWinters(myts_forecast, h=3)
forecast.HoltWinters(myts_forecast, h=4)
myts_forecast4 = forecast.HoltWinters(myts_forecast, h=4)
plot(myts_forecast4)
